# Disable directory browsing

Options -Indexes

<IfModule mod_headers.c>
    # Allow CORS for specific domains
    SetEnvIf Origin "http(s)?://(www\.)?(localhost|127\.0\.0\.1)$" AccessControlAllowOrigin=$0
    Header set Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
    
    # Allow methods used in application
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"

    # Allow necessary headers
    Header set Access-Control-Allow-Headers "Content-Type, Authorization"

    # Add anti-clickjacking header
    Header always set X-Frame-Options "DENY"

    # Content Security Policy Header
    Header set Content-Security-Policy "default-src 'self'; \
        script-src 'self' https://www.google-apis.com 'nonce-random123'; \
        style-src 'self' https://cdnjs.cloudflare.com https://use.fontawesome.com; \
        img-src 'self' data: https://*.cloudflare.com https://img.freepik.com https://i.pinimg.com https://www.wallpapertip.com https://i.pinimg.com https://lh3.googleusercontent.com; \
        connect-src 'self'; \
        font-src 'self' https://fonts.googleapis.com; \
        frame-ancestors 'none'; \
        form-action 'self'; \
        base-uri 'self';"

    
    Header set X-Content-Type-Options "nosniff"

</IfModule>

<FilesMatch "\.(ico|css|js|png|jpg|jpeg|svg|html|php)$">
    Header set X-Content-Type-Options "nosniff"
</FilesMatch>

<Files "favicon.ico">
    Header set X-Content-Type-Options "nosniff"
</Files>



AddType application/x-httpd-php .html
